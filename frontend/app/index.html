<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fliq-chat app</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    <link href="https://use.fontawesome.com/releases/v6.6.0/css/all.css" rel="stylesheet">
    <link rel="icon" href="../img/icon-01.png">
</head>
<body>  
    <div class="tools-menu"><a>Exit</a><a onclick="logout()">Logout</a><a>Options</a></div>
    <div class="server-error-overlay" id="serverErrorOverlay">
        <div class="server-error-popup">
            <div class="server-error-header">
                <div class="server-error-icon">✕</div>
            </div>
            <div class="server-error-body">
                <h2 class="server-error-title">Sorry!</h2>
                <p class="server-error-message">
                    Fliq’s server isn’t responding like it should. We're investigating. Please refresh or try again soon.
                </p>
                <button class="server-error-button" onclick="location.reload()">Refresh</button>
            </div>
        </div>
    </div>


    <div class="background">
        <div class="main-card">
            <div class="nav">
                <div class="header">
                    <h1>Good evening,</h1>
                    <span id="greeting"></span>
                </div>
                <div class="chat-overview-card">
                    <div class="custom-search-bar">
                        <input type="text"  id="search" placeholder="Search...">
                        <i class="fa fa-magnifying-glass"></i>
                    </div>
                    <div class="search-filter-bar">
                        <div class="labels">
                            <p class="label" onclick="switchFilter()">All</p>
                            <p class="label" onclick="switchFilter()">Spam</p>
                        </div>
                        <div id="selectionIndicator" class="selection-indicator"></div>
                    </div>

                    <!-- Hier neue Chaträume einfügen -->

                    <div class="chat-card-placeholder" id="chatCardPlaceholder">
                        <p style="margin-bottom: 5px;">You dont have any chats yet.</p>
                        <p style="font-size: 12px; opacity: 0.7;">Try adding someone</p>
                    </div>

                    
                    
                    
                    <div class="add-user-form" id="addUserForm" style="display: none;">
                        <h4>Add new user</h4>
                        <input type="text" id="newUsername" placeholder="Enter username...">
                        <button onclick="submitNewUserChat()" type="button">Add</button>
                    </div>
                    

                    <div class="add-user-btn" onclick="toggleAddUserForm()">
                        <i class="fa fa-plus"></i>
                        <p>Add User</p>
                    </div>


                </div>
            </div>
            <div class="chat-view">
                <div class="chat-view-nav-bar">
                    <div class="left-nav-bar">
                        <i class="fa fa-user"></i>
                        <div class="chat-bar-nav-name-online">
                            <h3 id="chatUserName">Loading...</h3>
                            <p id="chatUserStatus">Loading...</p>
                        </div>
                    </div>
                    <div class="right-nav-bar">
                        <i class="fa fa-ellipsis-vertical" onclick="openMenu()"></i>
                    </div>
                </div>
                <div class="chat-view-divider"></div>
                <div class="message-container">
                    <div class="messages" id="messages">
                        <!--Here will apper messages-->
                        <div class="placeholder-message"></div>
                    </div>
                </div>
                <div class="message-bar">
                    <div class="msg-bar-left">
                        <i class="fa fa-paperclip"></i>
                        <i class="fa fa-microphone"></i>
                    </div>
                    <div class="msg-bar-text">
                        <input id="msg-input" type="text" placeholder="Write a message...">
                    </div>
                    <div class="msg-bar-right">
                        <div id="input-btn" class="send-icon" onclick="sendMsg()">
                            <i class="fa fa-paper-plane"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    window.addEventListener("load", () => {
        const msgContainer = document.getElementById('messages');
        msgContainer.scrollTop = msgContainer.scrollHeight;
    })

    window.addEventListener("load", () => {
        const msgContainer = document.getElementById('messages');
        msgContainer.scrollTop = msgContainer.scrollHeight;

        const input = document.getElementById("msg-input");
        input.addEventListener("keydown", function(e) {
            if (e.key === "Enter") {
                e.preventDefault();
                sendMsg();
            }
        });
    });

</script>
<script src="script.js" defer></script>
</html>